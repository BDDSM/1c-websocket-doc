
.. _sphinx-chapter:
   
.. meta::
    :description: WebSocket сервер для 1С. Внешний компонент (Документация). Использование Сервера websocket для 1С: Предприятие
    :keywords: server, WebSocket, rpc

.. meta::
    :http-equiv=Content-Type: text/html; charset=utf-8

=======================================
Сервер Websocket
=======================================

Инициализация
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. index:: Новый
.. function:: Новый("AddIn.WebSocket.Server");

    Синоним: New()

    Инициализация внешнего компонента (Сервер). Полученный таким образом объект используется для дальнейшего взаимодействия.
    

Пример использования:

.. code-block:: bsl
   :linenos:

    Сервер = Новый("AddIn.WebSocket.Server");


Прослушивание порта
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. index:: Запустить
.. function:: Запустить(Интерфейс, Порт, Сертификат="", Ключ="", Пароль="")

    Синоним: Run()

    Захватывает порт для прослушивания и принимает в асинхронном режиме соединения и сообщения. Для получения тела сообщения используется метод Получить()

    Интерфейс   - Строка - Интерфейс для прослушивания, например "0.0.0.0."
    
    Порт        - Число - Числовой порт для прослушивания, наприр 8080
    
    Интерфейс   - Строка - (Необязательный) Путь к сертификату для организации SSL доступа

    Ключ        - Строка - (Необязательный) Путь к ключу для организации SSL доступа

    Пароль      - Строка - (Необязательный) Пароль ключа
    

Пример использования:

.. code-block:: bsl
   :linenos:

    Попытка
		
		Сервер.Запустить("127.0.0.1", 8098,"misc/ssl/cert.pem", "misc/ssl/key.pem", "1234")));
		
	Исключение
		
		Описание = ОписаниеОшибки();
		ТекстОшибки =  Сервер.ОписаниеОшибки();
		
		ТекстОписания = Описание + ": " + ТекстОшибки;
		
		ВызватьИсключение ТекстОписания;
		
	КонецПопытки;

        
Завершение прослушивания
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. index:: Остановить
.. function:: Остановить()

    Синоним: Stop()

    Завершает фоновую обработку соединений и освобождает порт. Исключений не вызывает
    

Пример использования:

.. code-block:: bsl
   :linenos:
    
    Сервер.Остановить();	
        

Отправка сообщения
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. index:: Отправить
.. function:: Отправить(ТелоСообщения)

    Синоним: Send()

    ТелоСообщения - Строка - Тело отправляемого сообщения

    Добавляет сообщение для фоновой отправки клиенту
    
Пример использования:

.. code-block:: bsl
   :linenos:
    
    ТелоСообщения = "Hello World 1C";

    Сервер.Отправить(ТелоСообщения);	